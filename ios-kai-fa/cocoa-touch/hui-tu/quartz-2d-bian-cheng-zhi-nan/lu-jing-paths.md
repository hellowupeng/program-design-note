# 路径（Paths）

路径定义了一个或多个形状或子路径。子路径可以由直线，曲线或两者组成。它可以打开或关闭。子路径可以是简单的形状，例如线条，圆形，矩形或星形，也可以是更复杂的形状，如山脉或抽象涂鸦的轮廓。图3-1显示了一些可以创建的路径。直线（在图的左上方）可以是虚线的;线条也可以是实心的。弯曲的路径（在中间顶部）由多条曲线组成，并且是一条开放的路径。同心圆被描边，但未被填充。加利福尼亚州是一条封闭的路径，由许多曲线组成，道路既被描边又被填充。星星说明了填充路径的两种选择，本章后面将介绍这些选项。

图3-1 Quartz支持基于路径的绘图：

### ![](/assets/Quartz supports path-based drawing.png) 路径创建和路径绘画

路径创建和路径绘制是独立的任务。首先你创建一条路径。当你想渲染一条路径时，你需要Quartz来绘制它。如图3-1所示，您可以选择描边路径，填充路径，或者同时描边和填充路径。您还可以使用路径来限制创建实际上剪切区域的路径边界内的其他对象的绘制。

图3-2显示了已绘制的路径，其中包含两个子路径。左边的子路径是一个矩形，而右边的子路径是由直线和曲线组成的抽象形状。每个子路径都被填充并且它的轮廓被描边。

图3-2 包含两个形状或子路径的路径

![](/assets/A path that contains two shapes, or subpaths.png)

图3-3 显示了独立绘制的多个路径。每条路径都包含一条随机生成的曲线，其中一些曲线被填充，另一些则被描边。绘图被剪辑区域限制为圆形区域。

图3-3 裁剪区域限制绘图

![](/assets/A clipping area constrains drawing.png)

### 构建块

子路径由线条（lines），弧线（arcs）和曲线（curves）构建而成。Quartz 还提供了很多方便的函数，用一个函数调用添加矩形和椭圆。点也是重要的路径构建块，因为点定义了形状的起始位置和结束位置。

##### 点（Points）

点是指定用户空间中位置的x和y坐标。您可以调用函数`CGContextMoveToPoint`来指定新子路径的起始位置。Quartz会跟踪当前点，这是用于路径构建的最后一个位置。例如，如果您调用函数`CGContextMoveToPoint`在（10,10）处设置位置，则会将当前点移动到（10,10）。如果你画一条50单位长的水平线，那么线上的最后一点，即（60,10）就成为当前点。直线\(Lines\)，圆弧\(arcs\)和曲线\(curves\)总是从当前点开始绘制。

大多数情况下，您通过传递Quartz函数的两个浮点值来指定x和y坐标来指定点。某些函数要求您传递一个`CGPoint`数据结构，该结构包含两个浮点值。

##### 线（Lines）

一条线由其端点定义。它的起点总是被假定为当前点，所以当你创建一条线时，你只能指定它的结束点（endpoint）。您可以使用函数`CGContextAddLineToPoint`将单行（line）附加到子路径。

通过调用函数`CGContextAddLines`，可以将一系列连接线添加到路径中。第一点必须是第一条线的起点;剩余的点是结束点。Quartz在第一个点开始一个新的子路径，并将一条直线段连接到每个结束点。

##### 弧（Arcs）

圆弧是圆形段。Quartz提供了两个创建弧的函数。函数`CGContextAddArc`从圆中创建一个曲线段。您可以指定圆的中心，半径和径向角（以弧度表示）。您可以通过指定2 pi的径向角度来创建一个完整的圆。图3-4显示了独立绘制的多个路径。每个路径包含一个随机生成的圆;一些被填充，另一些被描边。

图3-4 多条路径;每个路径都包含一个随机生成的圆

![](/assets/Multiple paths; each path contains a randomly generated circle.png)

`CGContextAddArcToPoint`函数是您想要圆角矩形的角的理想选择。Quartz使用您提供的端点来创建两条相切线。您还可以提供Quartz切割圆弧的圆的半径。圆弧的中心点是两个半径的交点，每个半径都垂直于两条切线中的一条。圆弧的每个端点（endpoint）都是其中一条切线上的切点，如图3-5所示。圆的红色部分是实际绘制的。

图3-5用两条切线和一个半径定义弧

![](/assets/Defining an arc with two tangent lines and a radius.png)

如果当前路径已经包含子路径，则Quartz将从当前点到弧的起点追加一条直线段。如果当前路径为空，则Quartz会在圆弧的起点处创建一个新的子路径，并且不会添加最初的直线段。

##### 曲线（Curves）

二次方和三次方贝塞尔（Bézier）曲线是代数曲线，可以指定任意数量的有趣的曲线形状。通过将多项式应用于起点和终点以及一个或多个控制点来计算这些曲线上的点。以这种方式定义的形状是矢量图形的基础。一个公式比一系列位存储更紧凑，并且具有曲线可以在任何分辨率下重新创建的优点。

图3-6显示了通过独立绘制多条路径创建的各种曲线。每条路径都包含随机生成的曲线;一些被填充，另一些被描边。

图3-6多条路径;每条路径都包含随机生成的曲线

![](/assets/Multiple paths; each path contains a randomly generated curve.png)

给出二次方和三次Bézier曲线的多项式以及如何从公式生成曲线的细节在很多描述计算机图形的数学文本和在线资源中讨论。这些细节不在这里讨论。

使用`CGContextAddCurveToPoint`函数可以使用控制点和指定的端点从当前点追加三次方Bézier曲线。图3-7显示了由图中显示的当前点，控制点和端点产生的三次Bézier曲线。两个控制点的位置决定曲线的几何形状。如果控制点都在起点和终点之上，则曲线向上拱起。如果控制点都低于起点和终点，则曲线向下拱起。

图3-7贝塞尔三次曲线使用两个控制点:

![](/assets/A cubic Bézier curve uses two control points.png)

您可以通过调用函数`CGContextAddQuadCurveToPoint`并指定控制点和端点（endpoint），从当前点追加二次方Bézier曲线。图3-8显示了使用相同端点但控制点不同的两条曲线。控制点确定曲线的方向。用二次Bézier曲线创建尽可能多的有趣形状，因为二次曲线只能使用一个控制点。例如，使用单个控制点创建分频器是不可能的。

图3-8 二次方贝塞尔曲线使用一个控制点

![](/assets/A quadratic Bézier curve uses one control point.png)

##### 关闭子路径（Closing a Subpath）

要关闭当前子路径，应用程序应调用`CGContextClosePath`。此函数添加从当前点到子路径起点的线段并关闭子路径。以子路径起点为终点的直线，圆弧和曲线实际上并不关闭子路径。您必须显式调用`CGContextClosePath`来关闭子路径。

一些Quartz函数将路径的子路径视为由应用程序关闭。这些命令对待每个子路径，就像应用程序调用`CGContextClosePath`关闭它一样，隐式地将一个线段添加到子路径的起始点。

在关闭一个子路径后，如果你的应用程序进行了额外的调用来将线，弧或曲线添加到路径中，Quartz将从刚刚关闭的子路径的起点开始一个新的子路径。

##### 椭圆（Ellipses）

##### 矩形（Rectangles）

### 创建一条路径

### 绘制一条路径

### 剪切到一条路径



